
## 请求格式

**URL简介**

统一资源定位符（Uniform Resource Locator，缩写为URL）是对可以从互联网上得到的资源的位置和访问方法的一种简洁的表示，是互联网上标准资源的地址。

互联网上的每个文件都有一个唯一的URL，它包含的信息指出文件的位置以及浏览器应该怎么处理它。

URL由三部分组成：资源类型、存放资源的主机域名、资源文件名。

URL的一般语法格式为：
protocol://hostname[:port]/path[?query]#fragment                   (带方括号[]的为可选项)

URL详细描述参见：[RFC1738](http://www.w3.org/Addressing/rfc1738.txt)

**请求格式**

云平台的请求串格式，使用URL的path+query来构成，语法为：

/path?query

- path    -  路径，由零或多个“/”符号隔开的字符串构成，指定云平台中对外提供的服务名。
- query  -  查询，用于传递查询参数，多个参数用“&”符号隔开，每个参数的名和值用“=”符号隔开；请求字符串的编码规范，完全符合URL。

**PATH部分**

path路径，指定云平台的应用服务名，通过它能唯一找到相应的应用服务来处理请求。

- /quote/dyna: 动态行情服务
- /cancel: 取消订阅服务
- /group: 请求组服务

**QUERY部分**

通用参数，对所有请求有效

- output - 可选。指定数据结果的返回格式：json（缺省值），protobuff

- qid - 必填(websocket协议)。请求ID，指定请求的唯一标识；请求ID最大长度支持32位，无字符内容限制。
	- 普通请求 - 同个连接通道下不可重复，不同通道不限制；重复ID的请求，UA不受理，直接返回异常响应。
	- 取消请求 - 和普通请求限制刚好相反，该参数值唯一指定通过该连接通道已被发送的请求标识；

  如果指定未知的请求标识或是已被处理过的单次查询请求标识，UA会返回找不到请求标识之类的错误。

  **注：该参数仅仅在Websocket通道下才有效；HTTP协议将被忽略。**

- sub - 可选。指定是否订阅更新。0: 不订阅（缺省值）, 1: 订阅

- token - 必填。http请求与websocket的连接时必须传入。访问令牌的获取，请参考【授权认证】章节。

注：HTTP下不存在推送订阅情况，设置sub=1时将返回错误响应。

**取消请求**

基于长连接通道(Websocket)的推送类请求，很多情况下我们都需要应用主动的来取消不再需要的服务，这样可以避免造成许多无必要的资源浪费。

云平台提供了通用的请求取消服务（/cancel）来取消指定请求。

服务示例：   /cancel?qid=req0001

服务PATH： /cancel

服务参数：   qid            唯一指定通过该连接通道已被发送的请求标识

**使用场景**

在不同的请求协议中，对请求串的使用可能会有些不同。

- http   -   需要构建完整的URL串来完成一次请求，构建方式：  http://hostname[:port] + 请求串。
- websocket   -   一个消息体（MESSAGE），即表示一次请求。 消息体内容使用请求串填充即可。
